{% extends 'base.html' %}
{% load static %}

{% block head %}
    <script src="{% static 'koolapic/js/group_details.js' %}" type="module"></script>
    <script src="{% static 'koolapic/js/tabs.js' %}"></script>
{% endblock %}

{% block content %}
    <div class="group-header gradient-l2 small-padding-container rounded-corner-container text-white">
        <img src="{{ group.image.url }}" alt="Bannière du groupe" class="group-banner">
        <div class="group-panel small-padding-container">
            <h1>{{ group.name }}</h1>

            <div class="group-members-overview d-none d-lg-block">
                <div class="members-overview mb-2">
                {% for user_p in members|slice:"10" %}
                    {% include 'includes/profile_picture.html' %}
                {% empty %}
                    <h1 class="empty">Aucun membre n'est présent dans ce groupe.</h1>
                {% endfor %}
                </div>

                {% if group.invitation_policy == "PU" and user not in members and user not in admins %}
                    <button id="joinButton" type="button" class="btn btn-secondary" onclick="join();">Rejoindre</button>
                {% endif %}

                {% if user in members %}
                    <button id="leaveButton" type="button" class="btn btn-secondary" onclick="leave();">Quitter</button>
                {% endif %}

                {% if members.count > 10 %}
                    <a href="#membersList" data-toggle="tab" role="link" aria-controls="link" class="undisplayed-elements-badge">+ {{ undisplayed_members_count }}</a>
                {% endif %}
            </div>
        </div>
        <ul class="nav nav-tabs group-nav">
            <li class="nav-item">
                <a class="nav-link active" data-toggle="tab" id="aboutTab" href="#about" role="tab" data-controls="about" aria-controls="about">A propos</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" id="membersTab" href="#members" role="tab" data-controls="members" aria-controls="members">Membres</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" id="managementTab" href="#management" role="tab" data-controls="management" aria-controls="management">Gestion</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" id="activitiesTab" href="#activities" role="tab" data-controls="activities" aria-controls="activities">Activités</a>
            </li>
        </ul>
        <div class="tab-content medium-padding-container">
            <div class="tab-pane active" id="about" role="tabpanel" aria-labelledby="aboutTab">
                {% include 'koolapic/groups/includes/about_group.html' %}
            </div>
            <div class="tab-pane" id="members" role="tabpanel" aria-labelledby="membersTab">
                {% include 'koolapic/groups/includes/group_members.html' %}
            </div>
            <div class="tab-pane" id="activities" role="tabpanel" aria-labelledby="activitiesTab">
                {% include 'koolapic/groups/includes/group_activities.html' %}
            </div>
            <div class="tab-pane" id="management" role="tabpanel" aria-labelledby="optionsTab">
                <h1>Options</h1>
            </div>
        </div>
    </div>


{% endblock content %}