{% extends 'base.html' %}
{% load static %}

{% block head %}
    <script src="{% static 'koolapic/js/notifications.js' %}" type="module"></script>
{% endblock %}

{% block navbar %}
    {{ block.super }}
{% endblock navbar %}

{% block content %}
    <button class="btn btn-secondary mb-3" onclick="markAllAsRead();"><i class="fas fa-check"></i> Tout marquer comme lu</button>
    <div class="notifications-list">
        {% for notification in notification_list %}
            {% if notification.severity != "DEBUG" %}
                {% with bg_image=notification.group.image.url %}
                    {% if notification.status == "U" %}
                        <div class="notification small-padding-container mb-2 notification-unread {% if bg_image %}image-notification{% endif %}" data-notification-id="{{ notification.id }}" {% if bg_image %} data-bg-image="{{ bg_image }}"{% endif %}>
                            <div class="d-flex flex-row align-items-right">
                                <div class="d-flex justify-content-start align-items-center mr-3">
                                    <button class="icon-btn p-2 toggle-read-btn" data-notification-id="{{ notification.id }}"><i class="far fa-square"></i></button>
                                </div>
                                <div class="d-flex align-items-center" {% if notification.link %}onclick="location.href='{{ notification.link }}'" style="cursor: pointer;" {% endif %}>
                                    <div class="flex-column">
                                        <div class="pl-1"><b>{{ notification.title }}</b></div>
                                        <div class="pl-1 pt-0">{{ notification.description }}</div>
                                        <small class="pl-1 pt-0">{{ notification.date_sent }}</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% elif notification.status == "R" %}
                        <div class="notification small-padding-container mb-2 notification-read {% if bg_image %}image-notification{% endif %}" data-notification-id="{{ notification.id }}" {% if bg_image %}data-bg-image="{{ bg_image }}" {% endif %}>
                            <div class="d-flex flex-row align-items-right">
                                <div class="d-flex justify-content-start align-items-center mr-3">
                                    <button class="icon-btn p-2 toggle-read-btn checked" data-notification-id="{{ notification.id }}"><i class="far fa-check-square"></i></button>
                                </div>
                                <div class="d-flex align-items-center" {% if notification.link %}onclick="location.href='{{ notification.link }}'" style="cursor: pointer;" {% endif %}>
                                    <div class="flex-column">
                                        <div class="pl-1"><b>{{ notification.title }}</b></div>
                                        <div class="pl-1 pt-0">{{ notification.description }}</div>
                                        <small class="pl-1 pt-0">{{ notification.date_sent }}</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endwith %}
            {% endif %}
        {% empty %}
            <div class="empty">
                Vous n'avez pas de notification...
            </div>
        {% endfor %}
    </div>
{% endblock %}